<!DOCTYPE html>
<html lang="en">
<meta charset=UTF-8>
 <title>Contoh Analisis On-Page dengan TinyMCE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tiny.cloud/1/a8u4hlknralxotdzfmtvtagxz3z8epiozjbp052yzmh1ghsc/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
</head>
<body>
    <h1>Contoh Form Input Konten</h1>
    <form>
        <label for="content">Konten Artikel</label>
        <textarea id="content" name="content"></textarea>
        <br>
        <label for="keyword-input">Kata Kunci</label>
        <input type="text" id="keyword-input" placeholder="Masukkan kata kunci">
        <br>
        <button type="button" onclick="analyze()">Analisis On-Page</button>
    </form>

    <h2>Hasil Analisis On-Page</h2>
    <p>Jumlah kata: <span id="word-count"></span></p>
    <p>Jumlah kata kunci: <span id="keyword-count"></span></p>
    <p>Kepadatan kata kunci: <span id="keyword-density"></span>%</p>
    <p>Heading tag yang kurang digunakan: <span id="heading-tags"></span></p>
    <p>Meta tag tidak terisi dengan benar: <span id="meta-tags"></span></p>

    <script>
        tinymce.init({
            selector: 'textarea',
            plugins: 'wordcount code',
            toolbar: 'undo redo | h1 h2 h3 h4 | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | image | wordcount',
            menubar: true,
            statusbar: true,
            formats: {
                h1: { block: 'h1' },
                h2: { block: 'h2' },
                h3: { block: 'h3' },
                h4: { block: 'h4' }
            }
        });

    function analyze() {
    const content = tinymce.get('content').getContent();
    const keywords = document.querySelector('#keyword-input').value.split(',');
    const wordCount = tinymce.get('content').plugins.wordcount.getCount();
    
    const keywordCounts = {};
    keywords.forEach(keyword => {
        const count = (content.match(new RegExp(keyword.trim(), 'gi')) || []).length;
        keywordCounts[keyword.trim()] = count;
    });

    const totalKeywordCount = Object.values(keywordCounts).reduce((total, count) => total + count, 0);
    const keywordDensity = ((totalKeywordCount / wordCount) * 100).toFixed(2);

    const unusedHeadings = Array.from(tinymce.get('content').dom.getRoot().querySelectorAll('h1, h2, h3, h4'))
        .filter(tag => !content.includes(tag.textContent))
        .map(tag => tag.tagName.toLowerCase());

    const missingMetaTags = !(tinymce.get('content').dom.getRoot().querySelectorAll('title').length > 0) ||
        !(tinymce.get('content').dom.getRoot().querySelectorAll('meta[name="description"]').length > 0);

    document.querySelector('#word-count').textContent = wordCount;
    document.querySelector('#keyword-count').textContent = totalKeywordCount;
    document.querySelector('#keyword-density').textContent = keywordDensity;
    document.querySelector('#heading-tags').textContent = unusedHeadings.join(', ');
    document.querySelector('#meta-tags').textContent = missingMetaTags ? 'Tidak ada' : 'Ada';
}

    </script>
</body>
</html>
